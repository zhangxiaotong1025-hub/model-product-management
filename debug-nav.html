<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¼èˆªè°ƒè¯•é¡µé¢ - PULSAR</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .debug-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 400px;
            max-height: 80vh;
            background: white;
            border: 2px solid #6366F1;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            overflow-y: auto;
            z-index: 10000;
            font-size: 13px;
        }
        .debug-panel h3 {
            margin: 0 0 15px 0;
            color: #6366F1;
            font-size: 16px;
        }
        .debug-section {
            margin-bottom: 15px;
            padding: 10px;
            background: #F8F9FA;
            border-radius: 6px;
        }
        .debug-section h4 {
            margin: 0 0 8px 0;
            font-size: 14px;
            color: #333;
        }
        .debug-item {
            padding: 5px 0;
            border-bottom: 1px solid #E2E8F0;
        }
        .debug-item:last-child {
            border-bottom: none;
        }
        .status-ok { color: #10B981; font-weight: bold; }
        .status-error { color: #EF4444; font-weight: bold; }
        .status-warning { color: #F59E0B; font-weight: bold; }
        .test-button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: #6366F1;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
        }
        .test-button:hover {
            background: #4F46E5;
        }
        .log-entry {
            padding: 5px;
            margin: 3px 0;
            background: white;
            border-left: 3px solid #6366F1;
            font-family: monospace;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <!-- è°ƒè¯•é¢æ¿ -->
    <div class="debug-panel">
        <h3>ğŸ” å¯¼èˆªè°ƒè¯•é¢æ¿</h3>
        
        <div class="debug-section">
            <h4>å¿«é€Ÿæµ‹è¯•</h4>
            <button class="test-button" onclick="testNavigation()">ğŸ§ª è¿è¡Œå®Œæ•´æµ‹è¯•</button>
            <button class="test-button" onclick="testClickEvents()">ğŸ‘† æµ‹è¯•ç‚¹å‡»äº‹ä»¶</button>
            <button class="test-button" onclick="testScrolling()">ğŸ“œ æµ‹è¯•æ»šåŠ¨åŠŸèƒ½</button>
            <button class="test-button" onclick="clearLogs()">ğŸ—‘ï¸ æ¸…ç©ºæ—¥å¿—</button>
        </div>
        
        <div class="debug-section">
            <h4>ç»“æ„æ£€æŸ¥</h4>
            <div id="structureCheck"></div>
        </div>
        
        <div class="debug-section">
            <h4>äº‹ä»¶ç›‘å¬å™¨</h4>
            <div id="eventCheck"></div>
        </div>
        
        <div class="debug-section">
            <h4>å®æ—¶æ—¥å¿—</h4>
            <div id="logOutput" style="max-height: 200px; overflow-y: auto;"></div>
        </div>
    </div>

    <!-- ä¾§è¾¹æ  -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-cube"></i>
                <span>PULSAR</span>
            </div>
        </div>
        
        <div class="sidebar-content">
            <nav class="nav-menu">
                <a href="index.html" class="nav-item">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
                
                <!-- é¡¹ç›®ç®¡ç† -->
                <div class="nav-group" data-group-name="é¡¹ç›®ç®¡ç†">
                    <div class="nav-group-title">
                        <i class="fas fa-project-diagram"></i>
                        <span>é¡¹ç›®ç®¡ç†</span>
                        <i class="fas fa-chevron-down toggle-icon"></i>
                    </div>
                    <div class="nav-group-items">
                        <a href="project-list.html" class="nav-item">
                            <span>é¡¹ç›®åˆ—è¡¨</span>
                        </a>
                        <a href="project-detail.html" class="nav-item">
                            <span>é¡¹ç›®è¯¦æƒ…</span>
                        </a>
                        <a href="plan-management.html" class="nav-item">
                            <span>æ–¹æ¡ˆç®¡ç†</span>
                        </a>
                    </div>
                </div>
                
                <a href="case-management.html" class="nav-item">
                    <i class="fas fa-images"></i>
                    <span>æ™ºèƒ½æ¡ˆä¾‹ç®¡ç†</span>
                </a>
            </nav>
            
            <div class="nav-divider">åŸºç¡€æ¨¡å—</div>
            
            <nav class="nav-menu">
                <a href="enterprise-management.html" class="nav-item">
                    <i class="fas fa-building"></i>
                    <span>ä¼ä¸šç®¡ç†</span>
                </a>
                <a href="model-management.html" class="nav-item">
                    <i class="fas fa-box"></i>
                    <span>æ¨¡å‹ç®¡ç†</span>
                </a>
                
                <!-- æƒé™ç®¡ç† -->
                <div class="nav-group" data-group-name="æƒé™ç®¡ç†">
                    <div class="nav-group-title">
                        <i class="fas fa-shield-alt"></i>
                        <span>æƒé™ç®¡ç†</span>
                        <i class="fas fa-chevron-down toggle-icon"></i>
                    </div>
                    <div class="nav-group-items">
                        <a href="menu-management.html" class="nav-item">
                            <span>èœå•ç®¡ç†</span>
                        </a>
                        <a href="role-management.html" class="nav-item">
                            <span>è§’è‰²ç®¡ç†</span>
                        </a>
                        <a href="policy-management.html" class="nav-item">
                            <span>ç­–ç•¥ç®¡ç†</span>
                        </a>
                    </div>
                </div>
            </nav>
        </div>
        
        <div class="sidebar-footer">
            <div class="user-profile">
                <img src="https://work.alibaba-inc.com/photo/482399.jpg" alt="User Avatar" class="user-avatar">
                <div class="user-info">
                    <div class="user-name">æ™´å²™</div>
                    <div class="user-email">qingao.zxt@alibaba-inc.com</div>
                </div>
            </div>
        </div>
    </aside>

    <!-- ä¸»å†…å®¹åŒº -->
    <main class="main-content">
        <header class="top-bar">
            <h1 class="page-title">å¯¼èˆªåŠŸèƒ½è°ƒè¯•é¡µé¢</h1>
        </header>

        <section class="content-section">
            <div class="card">
                <h2>ğŸ“‹ æµ‹è¯•è¯´æ˜</h2>
                <ol>
                    <li>ç‚¹å‡»å³ä¾§è°ƒè¯•é¢æ¿ä¸­çš„"è¿è¡Œå®Œæ•´æµ‹è¯•"æŒ‰é’®</li>
                    <li>æŸ¥çœ‹æµ‹è¯•ç»“æœå’Œå®æ—¶æ—¥å¿—</li>
                    <li>æ‰‹åŠ¨ç‚¹å‡»å·¦ä¾§çš„"æƒé™ç®¡ç†"èœå•ï¼Œè§‚å¯Ÿæ˜¯å¦èƒ½æ­£å¸¸å±•å¼€/æ”¶èµ·</li>
                    <li>ç‚¹å‡»"èœå•ç®¡ç†"é“¾æ¥ï¼Œè§‚å¯Ÿé¡µé¢è·³è½¬åèœå•çŠ¶æ€</li>
                    <li>å¦‚æœå‘ç°é—®é¢˜ï¼ŒæŸ¥çœ‹æ§åˆ¶å°ï¼ˆF12ï¼‰çš„è¯¦ç»†æ—¥å¿—</li>
                </ol>
                
                <h3 style="margin-top: 30px;">ğŸ¯ é¢„æœŸè¡Œä¸º</h3>
                <ul>
                    <li>âœ… ç‚¹å‡»"æƒé™ç®¡ç†"æ ‡é¢˜åº”è¯¥å±•å¼€/æ”¶èµ·å­èœå•</li>
                    <li>âœ… å±•å¼€ååº”è¯¥çœ‹åˆ°ä¸‰ä¸ªå­èœå•é¡¹</li>
                    <li>âœ… ç‚¹å‡»å­èœå•é¡¹åº”è¯¥è·³è½¬åˆ°å¯¹åº”é¡µé¢</li>
                    <li>âœ… é¡µé¢åˆ·æ–°åï¼Œå½“å‰é¡µé¢æ‰€åœ¨çš„èœå•ç»„åº”è¯¥è‡ªåŠ¨å±•å¼€</li>
                    <li>âœ… ä¾§è¾¹æ å†…å®¹åŒºåŸŸåº”è¯¥å¯ä»¥æ»šåŠ¨</li>
                </ul>
            </div>
        </section>
    </main>

    <script src="js/main.js"></script>
    <script>
        let logCount = 0;
        
        function addLog(message, type = 'info') {
            const logOutput = document.getElementById('logOutput');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.style.borderLeftColor = type === 'error' ? '#EF4444' : type === 'success' ? '#10B981' : '#6366F1';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logOutput.appendChild(entry);
            logOutput.scrollTop = logOutput.scrollHeight;
            logCount++;
        }
        
        function clearLogs() {
            document.getElementById('logOutput').innerHTML = '';
            logCount = 0;
            addLog('æ—¥å¿—å·²æ¸…ç©º');
        }
        
        function testNavigation() {
            addLog('ğŸ”„ å¼€å§‹è¿è¡Œå®Œæ•´æµ‹è¯•...', 'info');
            
            // æµ‹è¯•1: æ£€æŸ¥ç»“æ„
            const sidebar = document.querySelector('.sidebar');
            const sidebarHeader = document.querySelector('.sidebar-header');
            const sidebarContent = document.querySelector('.sidebar-content');
            const sidebarFooter = document.querySelector('.sidebar-footer');
            
            let structureHtml = '';
            if (sidebar && sidebarHeader && sidebarContent && sidebarFooter) {
                structureHtml += '<div class="debug-item"><span class="status-ok">âœ“</span> ä¾§è¾¹æ ä¸‰æ®µå¼ç»“æ„æ­£ç¡®</div>';
                addLog('âœ“ ä¾§è¾¹æ ç»“æ„æ£€æŸ¥é€šè¿‡', 'success');
            } else {
                structureHtml += '<div class="debug-item"><span class="status-error">âœ—</span> ä¾§è¾¹æ ç»“æ„é”™è¯¯</div>';
                addLog('âœ— ä¾§è¾¹æ ç»“æ„æ£€æŸ¥å¤±è´¥', 'error');
            }
            
            // æµ‹è¯•2: æ£€æŸ¥æ»šåŠ¨
            const contentStyle = window.getComputedStyle(sidebarContent);
            if (contentStyle.overflowY === 'auto' || contentStyle.overflowY === 'scroll') {
                structureHtml += '<div class="debug-item"><span class="status-ok">âœ“</span> ä¾§è¾¹æ æ”¯æŒæ»šåŠ¨</div>';
                addLog('âœ“ æ»šåŠ¨åŠŸèƒ½æ­£å¸¸', 'success');
            } else {
                structureHtml += '<div class="debug-item"><span class="status-error">âœ—</span> ä¾§è¾¹æ ä¸æ”¯æŒæ»šåŠ¨</div>';
                addLog('âœ— æ»šåŠ¨åŠŸèƒ½å¼‚å¸¸', 'error');
            }
            
            // æµ‹è¯•3: æ£€æŸ¥èœå•ç»„
            const navGroups = document.querySelectorAll('.nav-group');
            structureHtml += `<div class="debug-item"><span class="status-ok">âœ“</span> æ‰¾åˆ° ${navGroups.length} ä¸ªæŠ˜å èœå•ç»„</div>`;
            addLog(`âœ“ æ‰¾åˆ° ${navGroups.length} ä¸ªæŠ˜å èœå•ç»„`, 'success');
            
            // æµ‹è¯•4: æ£€æŸ¥æƒé™ç®¡ç†èœå•
            const permGroup = Array.from(navGroups).find(g => 
                g.querySelector('.nav-group-title')?.textContent.includes('æƒé™ç®¡ç†')
            );
            
            if (permGroup) {
                const items = permGroup.querySelectorAll('.nav-group-items .nav-item');
                structureHtml += `<div class="debug-item"><span class="status-ok">âœ“</span> æƒé™ç®¡ç†èœå•ç»„å­˜åœ¨ï¼ŒåŒ…å« ${items.length} ä¸ªå­é¡¹</div>`;
                addLog(`âœ“ æƒé™ç®¡ç†èœå•ç»„åŒ…å« ${items.length} ä¸ªå­é¡¹`, 'success');
                
                items.forEach(item => {
                    const text = item.textContent.trim();
                    addLog(`  - ${text}`, 'info');
                });
            } else {
                structureHtml += '<div class="debug-item"><span class="status-error">âœ—</span> æœªæ‰¾åˆ°æƒé™ç®¡ç†èœå•ç»„</div>';
                addLog('âœ— æœªæ‰¾åˆ°æƒé™ç®¡ç†èœå•ç»„', 'error');
            }
            
            document.getElementById('structureCheck').innerHTML = structureHtml;
            
            // æµ‹è¯•5: æ£€æŸ¥äº‹ä»¶ç›‘å¬å™¨
            testClickEvents();
            
            addLog('âœ… å®Œæ•´æµ‹è¯•å®Œæˆ', 'success');
        }
        
        function testClickEvents() {
            addLog('ğŸ§ª å¼€å§‹æµ‹è¯•ç‚¹å‡»äº‹ä»¶...', 'info');
            
            const navGroups = document.querySelectorAll('.nav-group');
            let eventHtml = '';
            let allPassed = true;
            
            navGroups.forEach((group, index) => {
                const title = group.querySelector('.nav-group-title');
                const groupName = group.getAttribute('data-group-name') || `èœå•ç»„${index + 1}`;
                
                if (!title) {
                    eventHtml += `<div class="debug-item"><span class="status-error">âœ—</span> ${groupName}: ç¼ºå°‘æ ‡é¢˜å…ƒç´ </div>`;
                    addLog(`âœ— ${groupName}: ç¼ºå°‘æ ‡é¢˜å…ƒç´ `, 'error');
                    allPassed = false;
                    return;
                }
                
                // æ¨¡æ‹Ÿç‚¹å‡»æµ‹è¯•
                const wasActive = group.classList.contains('active');
                title.click();
                const isNowActive = group.classList.contains('active');
                
                if (wasActive !== isNowActive) {
                    eventHtml += `<div class="debug-item"><span class="status-ok">âœ“</span> ${groupName}: ç‚¹å‡»å“åº”æ­£å¸¸</div>`;
                    addLog(`âœ“ ${groupName}: ç‚¹å‡»æµ‹è¯•é€šè¿‡ (${wasActive ? 'å±•å¼€â†’æ”¶èµ·' : 'æ”¶èµ·â†’å±•å¼€'})`, 'success');
                    // æ¢å¤åŸçŠ¶æ€
                    title.click();
                } else {
                    eventHtml += `<div class="debug-item"><span class="status-error">âœ—</span> ${groupName}: ç‚¹å‡»æ— å“åº”</div>`;
                    addLog(`âœ— ${groupName}: ç‚¹å‡»æµ‹è¯•å¤±è´¥`, 'error');
                    allPassed = false;
                }
            });
            
            if (allPassed) {
                eventHtml += '<div class="debug-item"><span class="status-ok">âœ“</span> æ‰€æœ‰èœå•ç»„ç‚¹å‡»äº‹ä»¶æ­£å¸¸</div>';
                addLog('âœ… ç‚¹å‡»äº‹ä»¶æµ‹è¯•å…¨éƒ¨é€šè¿‡', 'success');
            }
            
            document.getElementById('eventCheck').innerHTML = eventHtml;
        }
        
        function testScrolling() {
            addLog('ğŸ“œ å¼€å§‹æµ‹è¯•æ»šåŠ¨åŠŸèƒ½...', 'info');
            
            const sidebarContent = document.querySelector('.sidebar-content');
            const scrollHeight = sidebarContent.scrollHeight;
            const clientHeight = sidebarContent.clientHeight;
            
            addLog(`ä¾§è¾¹æ å†…å®¹é«˜åº¦: ${scrollHeight}px`, 'info');
            addLog(`ä¾§è¾¹æ å¯è§é«˜åº¦: ${clientHeight}px`, 'info');
            
            if (scrollHeight > clientHeight) {
                addLog('âœ“ å†…å®¹è¶…å‡ºå¯è§åŒºåŸŸï¼Œæ»šåŠ¨åŠŸèƒ½åº”è¯¥å¯ç”¨', 'success');
                
                // æµ‹è¯•æ»šåŠ¨
                sidebarContent.scrollTop = 100;
                setTimeout(() => {
                    if (sidebarContent.scrollTop > 0) {
                        addLog('âœ“ æ»šåŠ¨åŠŸèƒ½æ­£å¸¸å·¥ä½œ', 'success');
                    } else {
                        addLog('âœ— æ»šåŠ¨åŠŸèƒ½å¼‚å¸¸', 'error');
                    }
                    sidebarContent.scrollTop = 0;
                }, 100);
            } else {
                addLog('âš  å†…å®¹æœªè¶…å‡ºå¯è§åŒºåŸŸï¼Œæ— éœ€æ»šåŠ¨', 'info');
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.addEventListener('load', function() {
            setTimeout(() => {
                addLog('ğŸš€ é¡µé¢åŠ è½½å®Œæˆï¼Œè‡ªåŠ¨è¿è¡Œæµ‹è¯•...', 'info');
                testNavigation();
            }, 500);
        });
        
        // ç›‘å¬æ‰€æœ‰ç‚¹å‡»äº‹ä»¶
        document.addEventListener('click', function(e) {
            if (e.target.closest('.nav-group-title')) {
                const group = e.target.closest('.nav-group');
                const groupName = group.getAttribute('data-group-name') || 'æœªå‘½åèœå•ç»„';
                const isActive = group.classList.contains('active');
                addLog(`ğŸ‘† ç”¨æˆ·ç‚¹å‡»äº†"${groupName}" (${isActive ? 'å±•å¼€' : 'æ”¶èµ·'})`, 'info');
            }
        });
    </script>
</body>
</html>
